# Pragma

该字段值为`no-cache` 的时候，浏览器不会对该资源读取缓存，即每次都想服务器发一起请求。

```
Pragma: no-cache
```



# Expires

该字段值对应一个GMT，比如`Wed， 09 Aug 2017 08：47：38 GMT`来告诉浏览器资源缓存过期时间，如果没有过期则不发请求。但是这个时间是相对服务器而言，无法保证 与浏览器时间一致（如果修改了本地时间）。

```
Expiers: Wed， 09 Aug 2017 08：47：38 GMT
```

# Cache-Control

作为请求头：

|            字段             |                说明                |
| :-----------------------: | :------------------------------: |
|         no-cache          |       浏览器不直接使用缓存，向原服务器发起请求       |
|         no-store          |            所有内容都不会被缓存            |
|   max-age=delta-seconds   |  浏览器要请求一个存在不超过delta-seconds秒的资源  |
| max-stale[=delta-seconds] | 浏览器可以请求一个超过缓存时间delta-seconds秒的资源 |
|  min-fresh=delta-seconds  | 浏览器可以请求一个在delta-seconds秒内被更新过的资源 |
|       no-transform        |      浏览器要请求以恶搞实体数据没有被转换过的资源      |
|       only-if-cache       |         浏览器要获取缓存的内容(如果有)         |
|      cache-extension      |       自定义扩展值，如果服务器不识别则被忽略        |

作为相应头：

|          字段值           |            说明             |
| :--------------------: | :-----------------------: |
|         public         |        任何时候都要缓存资源         |
| Private[=“file-name”]  |      仅某些用户可以缓存响应的内容       |
|        no-cache        |           不使用缓存           |
|        no-store        |        所有内容都不会被缓存         |
|      no-transform      |       缓存文件时不能改变实体数据       |
|     only-if-cached     |         只从缓存获取内容          |
|    must-revalidate     |    只能向原服务器请求数据，失败返回504    |
|    proxy-revalidate    |       同上，但只能用于共享缓存        |
| max-age=delta-seconds  | delta-seconds秒内无需向服务器重复请求 |
| s-maxage=delta-seconds |       同上，但只能用于共享缓存        |
|    cache-extension     |    自定义扩展值，如果服务器不识别则被忽略    |

Cache-Control还允许自由组合可选值，例如`Cache-Control:max-age=3600,must-revalidate`表示该资源是从原服务器上取得的，缓存有效时间为3600秒。

# 缓存校验字段

### Last-Modified

服务器将资源传递给客户端时，会将资源最后更改的时间以“Last-Modified: GMT”的形式加在实体首部上一起返回给客户端。

客户端会为资源标记上该信息，下次再次请求时，会把该信息附带在请求报文中一并带给服务器去做检查，若传递的时间值与服务器上该资源最终修改时间是一致的，则说明该资源没有被修改过，直接返回`304`状态码，**内容为空**。

如果两个时间不一致，则服务器会发回该资源并返回`200`状态码，和第一次请求时类似。

1.  If-Modified-Since: Last-Modified-value

该请求首部告诉服务器如果客户端传来的最后修改时间与服务器上的一致，则直接回送`304` 和响应报头即可。

2.  If-Modified-Since: Last-Modified-value

若Last-Modified没有匹配上（资源在服务端的最后更新时间改变了），则应当返回`412`(Precondition Failed) 状态码给客户端。

### ETag

服务器会通过某种算法，给资源计算得出一个唯一标志符（比如md5标志），在把资源响应给客户端的时候，会在实体首部加上“ETag: 唯一标识符”一起返回给客户端。例如：

```
Etag: "5d8c72a5edda8d6a:3239"

```

客户端会保留该 ETag 字段，并在下一次请求时将其一并带过去给服务器。服务器只需要比较客户端传来的ETag跟自己服务器上该资源的ETag是否一致，就能很好地判断资源相对客户端而言是否被修改过了。
如果服务器发现ETag匹配不上，那么直接以常规GET `200`回包形式将新的资源（当然也包括了新的ETag）发给客户端；如果ETag是一致的，则直接返回`304`知会客户端直接使用本地缓存即可。

1.  If-None-Match: ETag-value

如果没有匹配到ETag，则需要重发资源数据，否则直接回送`304` 和响应报头即可。

2.  If-Match: ETag-value

如果没有匹配到ETag，或者收到了“ * ”值而当前并没有该资源实体，则应当返回`412`(Precondition Failed) 状态码给客户端。否则服务器直接忽略该字段。

# 头部对比

|      头部       | 优势和特点                                    | 劣势和问题                                    |
| :-----------: | :--------------------------------------- | :--------------------------------------- |
|    Expires    | HTTP 1.0 产物，可以在1.0 和1.1 中使用。以时刻标识失效时间    | 时间是由服务器发送的，如果服务器与本地之间不一致可能出现问题。到期之前的修改不可知。 |
| Cache-Control | HTTP 1.1 产物，以时间间隔标识失效时间，解决本地与服务器相对时间的问题。比Expires多了很多选项。 | HTTP 1.1才有的，不兼容1.0 。到期之前的修改不可知。          |
| LAst-Modified | 不存在版本问题，每次请求都会去服务器进行校验。对比最后修改时间，相同则返回304，不同则返回200和资源内容。 | 只要资源修改，不管内容是否发生实质改变，都会返回内容。以时刻作为标识，无法识别一秒内的多次修改。某些服务器不能得到文件的最后修改时间 |
|     ETag      | 不存在版本问题。能更加精确地判断资源是否被修改。                 | 计算ETag值需要性能损耗。分布式服务器存储的情况下，不同ETag算法会导致结果错误。 |



# 三种刷新方式

### 在URI输入栏输入然后回车，通过书签访问

浏览器首先进行验证是否需要发送请求

### F5，点击工具栏中的刷新，右键菜单重新加载

无论如何都会向服务器发送请求

### Ctrl+F5

完全从服务器拿回一份新的资源



